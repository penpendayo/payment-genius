name: ğŸŸ¤ãƒ“ãƒ«ãƒ‰â†’rsyncã‚³ãƒãƒ³ãƒ‰ã§Xã‚µãƒ¼ãƒãƒ¼ã«ãƒ‡ãƒ—ãƒ­ã‚¤
on: [issues]
jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: ğŸŸ¡SSHç”¨ã®ç§˜å¯†éµã‚’ä½œæˆ
        run: echo "$SSH_PRIVATE_KEY" > key && chmod 600 key
        env:
          SSH_PRIVATE_KEY: ${{ secrets.SSH_PRIVATE_KEY }}
      - name: ğŸŸ¡Node.jsã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
        uses: actions/setup-node@v2
        with:
          node-version: "14.x"
      - name: ğŸŸ¡npm install & npm run build
        run: |
          npm ci
          npm run build
      - name: ğŸŸ¡rsyncã‚³ãƒãƒ³ãƒ‰ã§ãƒ‡ãƒ—ãƒ­ã‚¤
        run: rsync -auvz -e "ssh -i key -o StrictHostKeyChecking=no -p 10022" --delete --checksum "./out/" "$USER_ID@$SERVER_HOST:/home/$USER_ID/penpen-dev.com/public_html/payment-genius/"
        env:
          USER_ID: ${{ secrets.USER_ID }}
          SERVER_HOST: ${{ secrets.SERVER_HOST }}
